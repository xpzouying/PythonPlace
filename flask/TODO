TODO:
[ ] Add test.
[ ] Add concurrence limit.
